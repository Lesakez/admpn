/* frontend/src/components/modals/panels/ExportPanel.scss */

/* Корневой класс для панели экспорта */
.export-panel {
  /* Progress Steps */
  .progress-steps {
    /* Используем утилиты CoreUI для flex и отступов */
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--cui-spacer); /* ~1rem */
    padding: var(--cui-spacer-x); /* ~1.5rem */
    background-color: var(--cui-secondary-bg-subtle);
    border-radius: var(--cui-border-radius);
    margin-bottom: var(--cui-spacer-y); /* ~2rem */
  }

  .step {
    /* Flex и центрирование */
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    opacity: 0.6;
    transition: opacity 0.3s ease;
    position: relative;

    &.active {
      opacity: 1;
      color: var(--cui-primary);
    }

    &.completed {
      opacity: 1;
      color: var(--cui-success);
    }

    /* Линия между шагами */
    &:not(:last-child)::after {
      content: '';
      position: absolute;
      top: 16px;
      left: calc(100% + var(--cui-spacer)); /* ~1rem */
      width: var(--cui-spacer-x); /* ~1.5rem */
      height: 2px;
      background: var(--cui-border-color);
    }

    &.completed:not(:last-child)::after {
      background: var(--cui-success);
    }
  }

  .step-number {
    /* Круглый индикатор */
    width: 32px;
    height: 32px;
    border-radius: var(--cui-border-radius-pill);
    background: var(--cui-body-bg);
    border: 2px solid var(--cui-border-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: var(--cui-font-weight-semibold);
    margin-bottom: var(--cui-spacer-xxs); /* ~0.5rem */
  }

  .step.active .step-number {
    background: var(--cui-primary);
    color: var(--cui-white);
    border-color: var(--cui-primary);
  }

  .step.completed .step-number {
    background: var(--cui-success);
    color: var(--cui-white);
    border-color: var(--cui-success);
  }

  .step-name {
    font-size: var(--cui-font-size-sm); /* ~0.875rem */
    font-weight: var(--cui-font-weight-medium);
    color: var(--cui-body-color);
  }

  /* Step Content */
  .step-content {
    min-height: 400px; /* Сохраняем минимальную высоту */
  }

  /* Export Types */
  .export-types {
    display: flex;
    flex-direction: column;
    gap: var(--cui-spacer); /* ~1rem */
  }

  .export-type {
    /* Используем утилиты для flex и отступов */
    display: flex;
    align-items: flex-start;
    gap: var(--cui-spacer); /* ~1rem */
    padding: var(--cui-spacer); /* ~1rem */
    border: 2px solid var(--cui-border-color);
    border-radius: var(--cui-border-radius-lg);
    cursor: pointer;
    background: var(--cui-body-bg);

    &:hover {
      border-color: var(--cui-primary);
    }

    &.selected {
      border-color: var(--cui-primary);
      background: var(--cui-primary-bg-subtle);
    }

    &.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    input[type="radio"] {
      margin-top: 0.125rem;
      accent-color: var(--cui-primary);
    }

    .content {
      flex: 1;
    }

    .title {
      font-weight: var(--cui-font-weight-semibold);
      margin-bottom: var(--cui-spacer-xxs); /* ~0.25rem */
      color: var(--cui-body-color);
    }

    .description {
      color: var(--cui-secondary-color);
      font-size: var(--cui-font-size-sm); /* ~0.875rem */
    }
  }

  /* Status List */
  .status-list {
    display: flex;
    flex-direction: column;
    gap: var(--cui-spacer-xs); /* ~0.5rem */
    max-height: 250px;
    overflow-y: auto;
    padding: var(--cui-spacer-xs); /* ~0.5rem */
    background: var(--cui-secondary-bg-subtle);
    border-radius: var(--cui-border-radius);
    border: 1px solid var(--cui-border-color);
  }

  .status-item {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: var(--cui-spacer-xs); /* ~0.5rem */
    border-radius: var(--cui-border-radius);
    gap: var(--cui-spacer-xs); /* ~0.5rem */

    &:hover {
      background: var(--cui-body-bg);
    }

    input[type="checkbox"] {
      accent-color: var(--cui-primary);
    }
  }

  /* Fields Grid */
  .fields-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--cui-spacer-xs); /* ~0.5rem */
    max-height: 200px;
    overflow-y: auto;
    padding: var(--cui-spacer); /* ~1rem */
    background: var(--cui-secondary-bg-subtle);
    border-radius: var(--cui-border-radius);
    border: 1px solid var(--cui-border-color);
  }

  .field-chip {
    display: flex;
    align-items: center;
    gap: var(--cui-spacer-xs); /* ~0.5rem */
    padding: var(--cui-spacer-xs) var(--cui-spacer); /* ~0.5rem 1rem */
    background: var(--cui-body-bg);
    border: 1px solid var(--cui-border-color);
    border-radius: var(--cui-border-radius-pill);
    cursor: pointer;
    user-select: none;

    &:hover {
      border-color: var(--cui-primary);
      background: var(--cui-primary-bg-subtle);
    }

    .label-name {
      font-size: var(--cui-font-size-sm); /* ~0.875rem */
      font-weight: var(--cui-font-weight-medium);
      color: var(--cui-body-color);
    }
  }

  /* Selected Fields Area */
  .selected-fields-area {
    min-height: 200px;
    border: 2px dashed var(--cui-border-color);
    border-radius: var(--cui-border-radius-lg);
    padding: var(--cui-spacer-x); /* ~1.5rem */
    background: var(--cui-secondary-bg-subtle);
  }

  .selected-fields-area:hover {
    border-color: var(--cui-primary);
  }

  .empty-drop-zone {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 150px;
    text-align: center;
    color: var(--cui-secondary-color);

    p {
      margin: var(--cui-spacer-xs) 0; /* ~0.5rem */
      font-weight: var(--cui-font-weight-medium);
    }
  }

  .selected-fields-list {
    display: flex;
    flex-direction: column;
    gap: var(--cui-spacer-xs); /* ~0.5rem */
  }

  .selected-field-item {
    display: flex;
    align-items: center;
    gap: var(--cui-spacer); /* ~1rem */
    padding: var(--cui-spacer); /* ~1rem */
    background: var(--cui-body-bg);
    border: 1px solid var(--cui-border-color);
    border-radius: var(--cui-border-radius);
    cursor: move;

    &:hover {
      border-color: var(--cui-primary);
    }

    .field-order {
      width: 28px;
      height: 28px;
      background: var(--cui-primary);
      color: var(--cui-white);
      border-radius: var(--cui-border-radius-pill);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--cui-font-size-sm); /* ~0.875rem */
      font-weight: var(--cui-font-weight-semibold);
      flex-shrink: 0;
    }

    .field-content {
      flex: 1;

      .field-label {
        font-weight: var(--cui-font-weight-semibold);
        color: var(--cui-body-color);
        display: block;
        margin-bottom: var(--cui-spacer-xxs); /* ~0.25rem */
      }
    }

    .field-actions {
      display: flex;
      gap: var(--cui-spacer-xxs); /* ~0.25rem */
    }
  }

  /* Template Input */
  .template-input {
    font-family: var(--cui-font-monospace);
    background: var(--cui-input-bg);
    border: 2px dashed var(--cui-border-color);
    border-radius: var(--cui-border-radius);
    font-size: var(--cui-font-size-sm); /* ~0.875rem */
  }

  /* Preview Box */
  .preview-box {
    background: var(--cui-secondary-bg-subtle);
    border: 1px solid var(--cui-border-color);
    border-radius: var(--cui-border-radius);
    padding: var(--cui-spacer); /* ~1rem */
    font-family: var(--cui-font-monospace);
    font-size: var(--cui-font-size-sm); /* ~0.875rem */
    margin-top: var(--cui-spacer-xs); /* ~0.5rem */

    pre {
      margin: 0;
      white-space: pre-wrap;
      color: var(--cui-body-color);
    }
  }

  /* Info List */
  .info-list {
    display: flex;
    flex-direction: column;
    gap: var(--cui-spacer-xs); /* ~0.5rem */
  }

  .info-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--cui-spacer-xs); /* ~0.5rem */
    background: var(--cui-secondary-bg-subtle);
    border-radius: var(--cui-border-radius);
    border: 1px solid var(--cui-border-color);

    .label {
      font-weight: var(--cui-font-weight-medium);
      color: var(--cui-secondary-color);
    }

    .value {
      font-weight: var(--cui-font-weight-semibold);
      color: var(--cui-body-color);
    }
  }

  /* Table Preview */
  .table-preview {
    font-size: var(--cui-font-size-sm); /* ~0.875rem */

    th {
      background: var(--cui-secondary-bg-subtle);
      color: var(--cui-body-color);
      border-bottom: 2px solid var(--cui-border-color);
      position: sticky;
      top: 0;
      z-index: 1;
      white-space: nowrap;
    }

    td {
      font-family: var(--cui-font-monospace);
      max-width: 150px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      border-bottom: 1px solid var(--cui-border-color);
    }
  }

  /* Export Footer */
  .export-footer {
    padding: var(--cui-spacer-x); /* ~1.5rem */
    background: var(--cui-secondary-bg-subtle);
    border-radius: var(--cui-border-radius);
    border: 1px solid var(--cui-border-color);
  }

  /* Filter Search */
  .filter-search .form-control {
    border: 1px solid var(--cui-border-color);
    border-radius: var(--cui-border-radius);
    background: var(--cui-input-bg);
    color: var(--cui-input-color);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .progress-steps {
      gap: var(--cui-spacer-xs); /* ~0.5rem */
      padding: var(--cui-spacer); /* ~1rem */
    }

    .step-number {
      width: 28px;
      height: 28px;
      font-size: var(--cui-font-size-sm); /* ~0.875rem */
    }

    .step-name {
      font-size: var(--cui-font-size-xs); /* ~0.75rem */
    }

    .fields-grid {
      max-height: 150px;
    }

    .selected-fields-area {
      min-height: 150px;
      padding: var(--cui-spacer); /* ~1rem */
    }

    .field-chip {
      font-size: var(--cui-font-size-xs); /* ~0.75rem */
      padding: var(--cui-spacer-xs) var(--cui-spacer); /* ~0.5rem 1rem */
    }

    .selected-field-item {
      padding: var(--cui-spacer-xs); /* ~0.5rem */
      gap: var(--cui-spacer-xs); /* ~0.5rem */
    }

    .export-footer {
      padding: var(--cui-spacer); /* ~1rem */
    }
  }

  /* Scrollbar Styling */
  .fields-grid::-webkit-scrollbar,
  .status-list::-webkit-scrollbar,
  .table-responsive::-webkit-scrollbar {
    width: 6px;
  }

  .fields-grid::-webkit-scrollbar-track,
  .status-list::-webkit-scrollbar-track,
  .table-responsive::-webkit-scrollbar-track {
    background: var(--cui-secondary-bg-subtle);
    border-radius: 3px;
  }

  .fields-grid::-webkit-scrollbar-thumb,
  .status-list::-webkit-scrollbar-thumb,
  .table-responsive::-webkit-scrollbar-thumb {
    background: var(--cui-secondary-color);
    border-radius: 3px;
  }
}